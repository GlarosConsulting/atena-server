# Migration `20200724191814-add-optional-to-some-fields`

This migration has been generated by Andr√© 'Dezzy' at 7/24/2020, 7:18:14 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."contracts" DROP CONSTRAINT IF EXiSTS "contracts_convenientExecutionId_fkey",
ALTER COLUMN "convenientExecutionId" DROP NOT NULL;

ALTER TABLE "public"."contracts_details" DROP CONSTRAINT IF EXiSTS "contracts_details_contractId_fkey",
ALTER COLUMN "contractId" DROP NOT NULL;

ALTER TABLE "public"."execution_processes" DROP CONSTRAINT IF EXiSTS "execution_processes_convenientExecutionId_fkey",
ALTER COLUMN "convenientExecutionId" DROP NOT NULL;

ALTER TABLE "public"."execution_processes_details" DROP CONSTRAINT IF EXiSTS "execution_processes_details_executionProcessRelId_fkey",
ALTER COLUMN "executionProcessRelId" DROP NOT NULL;

ALTER TABLE "public"."contracts" ADD FOREIGN KEY ("convenientExecutionId")REFERENCES "public"."convenient_execution"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."contracts_details" ADD FOREIGN KEY ("contractId")REFERENCES "public"."contracts"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."execution_processes" ADD FOREIGN KEY ("convenientExecutionId")REFERENCES "public"."convenient_execution"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."execution_processes_details" ADD FOREIGN KEY ("executionProcessRelId")REFERENCES "public"."execution_processes"("id") ON DELETE SET NULL  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200717110508-alter-agreements-field-on-company-model..20200724191814-add-optional-to-some-fields
--- datamodel.dml
+++ datamodel.dml
@@ -2,9 +2,9 @@
 // learn more about it in the docs: https://pris.ly/d/prisma-schema
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -101,9 +101,9 @@
   proposalData                  ProposalData? @relation(fields: [proposalDataId], references: [id])
   proposalDataId                String?
   modality                      String?
   contractingStatus             String?
-  status                        Status
+  status                        Status?
   proposalId                    String?
   organId                       String?
   processId                     String?
   proponent                     String?
@@ -270,14 +270,14 @@
 model DisbursementChronoValues {
   @@map(name: "disbursement_chrono_values")
-  id                   String                  @default(uuid()) @id
-  disbursementChrono   DisbursementChrono?     @relation(fields: [disbursementChronoId], references: [id])
+  id                   String                   @default(uuid()) @id
+  disbursementChrono   DisbursementChrono?      @relation(fields: [disbursementChronoId], references: [id])
   disbursementChronoId String?
-  registered           DisbursementChronoValue @relation("RegisteredDisbursementChronoValue")
-  register             DisbursementChronoValue @relation("RegisterDisbursementChronoValue")
-  total                DisbursementChronoValue @relation("TotalDisbursementChronoValue")
+  registered           DisbursementChronoValue? @relation("RegisteredDisbursementChronoValue")
+  register             DisbursementChronoValue? @relation("RegisterDisbursementChronoValue")
+  total                DisbursementChronoValue? @relation("TotalDisbursementChronoValue")
 }
 model DisbursementChronoValue {
   @@map(name: "disbursement_chrono_value")
@@ -323,18 +323,18 @@
 model DetailedApplicationPlanValues {
   @@map(name: "detailed_application_plan_values")
-  id                        String                       @default(uuid()) @id
-  detailedApplicationPlan   DetailedApplicationPlan?     @relation(fields: [detailedApplicationPlanId], references: [id])
+  id                        String                        @default(uuid()) @id
+  detailedApplicationPlan   DetailedApplicationPlan?      @relation(fields: [detailedApplicationPlanId], references: [id])
   detailedApplicationPlanId String?
-  assets                    DetailedApplicationPlanValue @relation("AssetsDetailedApplicationPlanValue")
-  tributes                  DetailedApplicationPlanValue @relation("TributesDetailedApplicationPlanValue")
-  construction              DetailedApplicationPlanValue @relation("ConstructionDetailedApplicationPlanValue")
-  services                  DetailedApplicationPlanValue @relation("ServicesDetailedApplicationPlanValue")
-  others                    DetailedApplicationPlanValue @relation("OthersDetailedApplicationPlanValue")
-  administrative            DetailedApplicationPlanValue @relation("AdministrativeDetailedApplicationPlanValue")
-  total                     DetailedApplicationPlanValue @relation("TotalDetailedApplicationPlanValue")
+  assets                    DetailedApplicationPlanValue? @relation("AssetsDetailedApplicationPlanValue")
+  tributes                  DetailedApplicationPlanValue? @relation("TributesDetailedApplicationPlanValue")
+  construction              DetailedApplicationPlanValue? @relation("ConstructionDetailedApplicationPlanValue")
+  services                  DetailedApplicationPlanValue? @relation("ServicesDetailedApplicationPlanValue")
+  others                    DetailedApplicationPlanValue? @relation("OthersDetailedApplicationPlanValue")
+  administrative            DetailedApplicationPlanValue? @relation("AdministrativeDetailedApplicationPlanValue")
+  total                     DetailedApplicationPlanValue? @relation("TotalDetailedApplicationPlanValue")
 }
 model DetailedApplicationPlanValue {
   @@map(name: "detailed_application_plan_value")
@@ -366,9 +366,9 @@
   id         String                            @default(uuid()) @id
   workPlan   WorkPlan?                         @relation(fields: [workPlanId], references: [id])
   workPlanId String?
   list       ConsolidatedApplicationPlanItem[] @relation("ListConsolidatedApplicationPlanItems")
-  total      ConsolidatedApplicationPlanItem   @relation("TotalConsolidatedApplicationPlanItems")
+  total      ConsolidatedApplicationPlanItem?  @relation("TotalConsolidatedApplicationPlanItems")
 }
 model ConsolidatedApplicationPlanItem {
   @@map(name: "consolidated_application_plan_items")
@@ -446,10 +446,10 @@
 model ExecutionProcess {
   @@map(name: "execution_processes")
   id                    String                   @default(uuid()) @id
-  convenientExecution   ConvenientExecution      @relation(fields: [convenientExecutionId], references: [id])
-  convenientExecutionId String
+  convenientExecution   ConvenientExecution?     @relation(fields: [convenientExecutionId], references: [id])
+  convenientExecutionId String?
   executionId           String?
   type                  String?
   date                  DateTime?
   processId             String?
@@ -462,11 +462,11 @@
 model ExecutionProcessDetails {
   @@map(name: "execution_processes_details")
-  id                    String           @default(uuid()) @id
-  executionProcessRel   ExecutionProcess @relation(fields: [executionProcessRelId], references: [id])
-  executionProcessRelId String
+  id                    String            @default(uuid()) @id
+  executionProcessRel   ExecutionProcess? @relation(fields: [executionProcessRelId], references: [id])
+  executionProcessRelId String?
   executionProcess      String?
   buyType               String?
   status                String?
   origin                String?
@@ -490,11 +490,11 @@
 model Contract {
   @@map(name: "contracts")
-  id                    String              @default(uuid()) @id
-  convenientExecution   ConvenientExecution @relation(fields: [convenientExecutionId], references: [id])
-  convenientExecutionId String
+  id                    String               @default(uuid()) @id
+  convenientExecution   ConvenientExecution? @relation(fields: [convenientExecutionId], references: [id])
+  convenientExecutionId String?
   contractId            String?
   biddingId             String?
   date                  DateTime?
   details               ContractDetails?
@@ -503,10 +503,10 @@
 model ContractDetails {
   @@map(name: "contracts_details")
   id                 String    @default(uuid()) @id
-  contract           Contract  @relation(fields: [contractId], references: [id])
-  contractId         String
+  contract           Contract? @relation(fields: [contractId], references: [id])
+  contractId         String?
   hiredDocument      String?
   hirerDocument      String?
   type               String?
   object             String?
```


